import{u as C}from"./BMmzWbhp.js";import{_ as M}from"./CNX-lhOV.js";import{g as P,c as r,o as n,a as d,b as k,t as $,w as V,d as A,j as B,k as h,n as b,l as i,F as w,r as x,m as N,p as E,q as F}from"./CDlFDOG0.js";const I={class:"card"},L={class:"card__image"},R=["src"],j={class:"card__content"},q={class:"card__preview"},z="/images/no_image.png",D=P({__name:"PostCard",props:{id:{},image:{},preview:{}},setup(v){function l(a){const t=a.target;t&&(t.src=z)}return(a,t)=>{const c=M;return n(),r("div",I,[d("div",L,[d("img",{src:a.image,alt:"post",onError:l},null,40,R)]),d("div",j,[d("p",q,$(a.preview),1),k(c,{class:"card__link",to:`/posts/${a.id}`},{default:V(()=>t[0]||(t[0]=[A("Read more")])),_:1,__:[0]},8,["to"])])])}}}),S={class:"pagination"},T=["disabled"],U=["onClick"],G=["disabled"],H=P({__name:"Pagination",props:{currentPage:{},totalPages:{}},emits:["update:page"],setup(v,{emit:l}){const a=v,{currentPage:t,totalPages:c}=B(a);console.log(c);const g=l,m=s=>{console.log(s),s>=1&&s<=c.value&&g("update:page",s)},p=h(()=>{console.log("test");const s=5,_=Math.floor(s/2);let e=Math.max(1,t.value-_);const o=Math.min(c.value,e+s-1);return e=Math.max(1,o-s+1),Array.from({length:o-e+1},(u,y)=>e+y)});return console.log(p),(s,_)=>(n(),r("div",S,[d("button",{class:b(["pagination__button","pagination__left",i(t)===1?"invisible":""]),onClick:_[0]||(_[0]=e=>m(i(t)-1)),disabled:i(t)===1},"«",10,T),(n(!0),r(w,null,x(p.value,e=>(n(),r("button",{class:b(["pagination__button pagination__num",{active:e===i(t)}]),key:e,onClick:o=>m(e)},$(e),11,U))),128)),d("button",{class:"pagination__button pagination__right",onClick:_[1]||(_[1]=e=>m(i(t)+1)),disabled:i(t)===i(c)},"»",8,G)]))}}),J={class:"blog"},K={class:"container"},O={key:0,class:"blog__loading"},Q={key:1,class:"blog__error"},W={key:2,class:"blog__list"},f=8,tt=P({__name:"index",async setup(v){let l,a;const t=N(1),{getAllPosts:c}=C(),{data:g,pending:m,error:p}=([l,a]=E(()=>c()),l=await l,a(),l),s=h(()=>{if(!g.value)return[];const e=(t.value-1)*f,o=e+f;return g.value.slice(e,o)}),_=h(()=>g.value?Math.ceil(g.value.length/f):0);return(e,o)=>(n(),r("section",J,[d("div",K,[o[1]||(o[1]=d("h1",{class:"blog__title"},"Articles",-1)),i(m)?(n(),r("div",O,"Загрузка...")):i(p)?(n(),r("div",Q,"Ошибка при загрузке")):(n(),r("div",W,[(n(!0),r(w,null,x(s.value,u=>(n(),F(D,{key:u.id,id:u.id,image:u.image,preview:u.preview},null,8,["id","image","preview"]))),128))])),k(H,{currentPage:t.value,totalPages:_.value,"onUpdate:page":o[0]||(o[0]=u=>t.value=u)},null,8,["currentPage","totalPages"])])]))}});export{tt as default};
