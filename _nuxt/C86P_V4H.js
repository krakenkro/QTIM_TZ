import{u as C}from"./DmF2-q8C.js";import{_ as V}from"./DaYvUtvC.js";import{g as f,c as i,o as n,a as _,b as k,t as $,w as M,d as A,j as B,k as b,n as h,l as o,F as x,r as w,m as N,p as E,q as F}from"./Cnb_JpFz.js";const I={class:"card"},L={class:"card__image"},R=["src"],j={class:"card__content"},q={class:"card__preview"},z="/images/no_image.png",D=f({__name:"PostCard",props:{id:{},image:{},preview:{}},setup(p){function r(s){const t=s.target;t&&(t.src=z)}return(s,t)=>{const c=V;return n(),i("div",I,[_("div",L,[_("img",{src:s.image,alt:"post",onError:r},null,40,R)]),_("div",j,[_("p",q,$(s.preview),1),k(c,{class:"card__link",to:`/posts/${s.id}`},{default:M(()=>t[0]||(t[0]=[A("Read more")])),_:1,__:[0]},8,["to"])])])}}}),S={class:"pagination"},T=["disabled"],U=["onClick"],G=["disabled"],H=f({__name:"Pagination",props:{currentPage:{},totalPages:{}},emits:["update:page"],setup(p,{emit:r}){const s=p,{currentPage:t,totalPages:c}=B(s),g=r,m=d=>{d>=1&&d<=c.value&&g("update:page",d)},v=b(()=>{const l=Math.floor(2.5);let e=Math.max(1,t.value-l);const a=Math.min(c.value,e+5-1);return e=Math.max(1,a-5+1),Array.from({length:a-e+1},(u,y)=>e+y)});return(d,l)=>(n(),i("div",S,[_("button",{class:h(["pagination__button","pagination__left",o(t)===1?"invisible":""]),onClick:l[0]||(l[0]=e=>m(o(t)-1)),disabled:o(t)===1},"«",10,T),(n(!0),i(x,null,w(v.value,e=>(n(),i("button",{class:h(["pagination__button pagination__num",{active:e===o(t)}]),key:e,onClick:a=>m(e)},$(e),11,U))),128)),_("button",{class:"pagination__button pagination__right",onClick:l[1]||(l[1]=e=>m(o(t)+1)),disabled:o(t)===o(c)},"»",8,G)]))}}),J={class:"blog"},K={class:"container"},O={key:0,class:"blog__loading"},Q={key:1,class:"blog__error"},W={key:2,class:"blog__list"},P=8,tt=f({__name:"index",async setup(p){let r,s;const t=N(1),{getAllPosts:c}=C(),{data:g,pending:m,error:v}=([r,s]=E(()=>c()),r=await r,s(),r),d=b(()=>{if(!g.value)return[];const e=(t.value-1)*P,a=e+P;return g.value.slice(e,a)}),l=b(()=>g.value?Math.ceil(g.value.length/P):0);return(e,a)=>(n(),i("section",J,[_("div",K,[a[1]||(a[1]=_("h1",{class:"blog__title"},"Articles",-1)),o(m)?(n(),i("div",O,"Загрузка...")):o(v)?(n(),i("div",Q,"Ошибка при загрузке")):(n(),i("div",W,[(n(!0),i(x,null,w(d.value,u=>(n(),F(D,{key:u.id,id:u.id,image:u.image,preview:u.preview},null,8,["id","image","preview"]))),128))])),k(H,{currentPage:t.value,totalPages:l.value,"onUpdate:page":a[0]||(a[0]=u=>t.value=u)},null,8,["currentPage","totalPages"])])]))}});export{tt as default};
