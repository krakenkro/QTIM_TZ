import{u as y}from"./DmefDbfg.js";import{_ as V}from"./4JMhyTGK.js";import{g as f,j as M,c as r,o,a as _,b as $,t as k,w as A,d as B,k as N,l as P,n as h,m as i,F as x,r as w,p as R,q as E,s as L}from"./D4TXX7QE.js";const F={class:"card"},I={class:"card__image"},U=["src"],j={class:"card__content"},q={class:"card__preview"},z=f({__name:"PostCard",props:{id:{},image:{},preview:{}},setup(p){const{baseURL:l}=M().app,m=`${l}no_image.png`;function e(a){const s=a.target;s&&(s.src=m)}return(a,s)=>{const d=V;return o(),r("div",F,[_("div",I,[_("img",{src:a.image,alt:"post",onError:e},null,40,U)]),_("div",j,[_("p",q,k(a.preview),1),$(d,{class:"card__link",to:`/posts/${a.id}`},{default:A(()=>s[0]||(s[0]=[B("Read more")])),_:1,__:[0]},8,["to"])])])}}}),D={class:"pagination"},S=["disabled"],T=["onClick"],G=["disabled"],H=f({__name:"Pagination",props:{currentPage:{},totalPages:{}},emits:["update:page"],setup(p,{emit:l}){const m=p,{currentPage:e,totalPages:a}=N(m),s=l,d=u=>{u>=1&&u<=a.value&&s("update:page",u)},v=P(()=>{const c=Math.floor(2.5);let t=Math.max(1,e.value-c);const n=Math.min(a.value,t+5-1);return t=Math.max(1,n-5+1),Array.from({length:n-t+1},(g,C)=>t+C)});return(u,c)=>(o(),r("div",D,[_("button",{class:h(["pagination__button","pagination__left",i(e)===1?"invisible":""]),onClick:c[0]||(c[0]=t=>d(i(e)-1)),disabled:i(e)===1},"«",10,S),(o(!0),r(x,null,w(v.value,t=>(o(),r("button",{class:h(["pagination__button pagination__num",{active:t===i(e)}]),key:t,onClick:n=>d(t)},k(t),11,T))),128)),_("button",{class:"pagination__button pagination__right",onClick:c[1]||(c[1]=t=>d(i(e)+1)),disabled:i(e)===i(a)},"»",8,G)]))}}),J={class:"blog"},K={class:"container"},O={key:0,class:"blog__loading"},Q={key:1,class:"blog__error"},W={key:2,class:"blog__list"},b=8,tt=f({__name:"index",async setup(p){let l,m;const e=R(1),{getAllPosts:a}=y(),{data:s,pending:d,error:v}=([l,m]=E(()=>a()),l=await l,m(),l),u=P(()=>{if(!s.value)return[];const t=(e.value-1)*b,n=t+b;return s.value.slice(t,n)}),c=P(()=>s.value?Math.ceil(s.value.length/b):0);return(t,n)=>(o(),r("section",J,[_("div",K,[n[1]||(n[1]=_("h1",{class:"blog__title"},"Articles",-1)),i(d)?(o(),r("div",O,"Загрузка...")):i(v)?(o(),r("div",Q,"Ошибка при загрузке")):(o(),r("div",W,[(o(!0),r(x,null,w(u.value,g=>(o(),L(z,{key:g.id,id:g.id,image:g.image,preview:g.preview},null,8,["id","image","preview"]))),128))])),$(H,{currentPage:e.value,totalPages:c.value,"onUpdate:page":n[0]||(n[0]=g=>e.value=g)},null,8,["currentPage","totalPages"])])]))}});export{tt as default};
