import{u as y}from"./Chrd_Hif.js";import{_ as V}from"./BAkhgbwc.js";import{g as f,j as M,c as r,o,a as _,b as $,t as k,w as A,d as B,k as N,l as P,n as h,m as i,F as x,r as w,p as R,q as E,s as L}from"./Bd9uAmqY.js";const F={class:"card"},I={class:"card__image"},U=["src"],j={class:"card__content"},q={class:"card__preview"},z=f({__name:"PostCard",props:{id:{},image:{},preview:{}},setup(v){const{baseURL:l}=M().app,m=`${l}no_image.png`;function e(s){const a=s.target;a&&(a.src=m)}return(s,a)=>{const d=V;return o(),r("div",F,[_("div",I,[_("img",{src:s.image,alt:"post",onError:e},null,40,U)]),_("div",j,[_("p",q,k(s.preview),1),$(d,{class:"card__link",to:`/posts/${s.id}`},{default:A(()=>a[0]||(a[0]=[B("Read more")])),_:1,__:[0]},8,["to"])])])}}}),D={class:"pagination"},S=["disabled"],T=["onClick"],G=["disabled"],H=f({__name:"Pagination",props:{currentPage:{},totalPages:{}},emits:["update:page"],setup(v,{emit:l}){const m=v,{currentPage:e,totalPages:s}=N(m);console.log(s);const a=l,d=u=>{u>=1&&u<=s.value&&a("update:page",u)},p=P(()=>{const c=Math.floor(2.5);let t=Math.max(1,e.value-c);const n=Math.min(s.value,t+5-1);return t=Math.max(1,n-5+1),Array.from({length:n-t+1},(g,C)=>t+C)});return console.log(p),(u,c)=>(o(),r("div",D,[_("button",{class:h(["pagination__button","pagination__left",i(e)===1?"invisible":""]),onClick:c[0]||(c[0]=t=>d(i(e)-1)),disabled:i(e)===1},"«",10,S),(o(!0),r(x,null,w(p.value,t=>(o(),r("button",{class:h(["pagination__button pagination__num",{active:t===i(e)}]),key:t,onClick:n=>d(t)},k(t),11,T))),128)),_("button",{class:"pagination__button pagination__right",onClick:c[1]||(c[1]=t=>d(i(e)+1)),disabled:i(e)===i(s)},"»",8,G)]))}}),J={class:"blog"},K={class:"container"},O={key:0,class:"blog__loading"},Q={key:1,class:"blog__error"},W={key:2,class:"blog__list"},b=8,tt=f({__name:"index",async setup(v){let l,m;const e=R(1),{getAllPosts:s}=y(),{data:a,pending:d,error:p}=([l,m]=E(()=>s()),l=await l,m(),l),u=P(()=>{if(!a.value)return[];const t=(e.value-1)*b,n=t+b;return a.value.slice(t,n)}),c=P(()=>a.value?Math.ceil(a.value.length/b):0);return(t,n)=>(o(),r("section",J,[_("div",K,[n[1]||(n[1]=_("h1",{class:"blog__title"},"Articles",-1)),i(d)?(o(),r("div",O,"Загрузка...")):i(p)?(o(),r("div",Q,"Ошибка при загрузке")):(o(),r("div",W,[(o(!0),r(x,null,w(u.value,g=>(o(),L(z,{key:g.id,id:g.id,image:g.image,preview:g.preview},null,8,["id","image","preview"]))),128))])),$(H,{currentPage:e.value,totalPages:c.value,"onUpdate:page":n[0]||(n[0]=g=>e.value=g)},null,8,["currentPage","totalPages"])])]))}});export{tt as default};
